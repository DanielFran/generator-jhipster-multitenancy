        } else if (userRepository.findOneByEmail(managedUserVM.getEmail()).isPresent()) {
            return ResponseEntity.badRequest()
                .headers(HeaderUtil.createFailureAlert(ENTITY_NAME, "emailexists", "Email already in use"))
                .body(null);
        } else if ((managedUserVM.getAuthorities().contains(AuthoritiesConstants.ADMIN) || 
                managedUserVM.getAuthorities().contains(AuthoritiesConstants.USER) && managedUserVM.get<%= tenantNameUpperFirst %>() != null)
                || (managedUserVM.getAuthorities().contains("ROLE_<%= tenantNameUpperCase %>_ADMIN") || 
                managedUserVM.getAuthorities().contains("ROLE_<%= tenantNameUpperCase %>_USER") && managedUserVM.get<%= tenantNameUpperFirst %>() == null)) {
                return ResponseEntity.badRequest()
                .headers(HeaderUtil.createFailureAlert(ENTITY_NAME, "invalidrole", "Invalid Role"))
                .body(null);
        } else {
